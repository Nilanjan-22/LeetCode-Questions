class Solution {
public:
    int count(vector<vector<int>>& adj, int ignore, vector<int>& initial){
        vector<int> vis(adj.size(),0);
        queue<int> q;
        int cnt=0;
        for(int i=0;i<initial.size();i++){
            if(initial[i]==ignore)continue;
            q.push(initial[i]);
            vis[initial[i]]=1;
        }

        while(!q.empty()){
            int node=q.front();
            q.pop();
            cnt++;
            for(auto it: adj[node]){
                if(!vis[it] && it!=ignore){
                    vis[it]=1;
                    q.push(it);
                }
            }
        }
        return cnt;
    }
    int minMalwareSpread(vector<vector<int>>& graph, vector<int>& initial) {
        int n=graph.size();
        vector<vector<int>> adj(n);
        vector<int> vis(n,0);

        for(int i=0;i<n;i++){
            for(int j=0;j<n;j++){
                if(graph[i][j]==1)adj[i].push_back(j);
            }
        }

        queue<int> q;
        int total_inf=0;
        for(int i=0;i<initial.size();i++){
            q.push(initial[i]);
            vis[initial[i]]=1;
        }

        while(!q.empty()){
            int node=q.front();
            q.pop();
            total_inf++;
            for(auto it: adj[node]){
                if(!vis[it]){
                    vis[it]=1;
                    q.push(it);
                }
            }
        }
        sort(initial.begin(),initial.end());
        int ans=-1,mc=-1;
        for(int i=0;i<initial.size();i++){
            int change=total_inf-count(adj,initial[i],initial);
            if(change>mc){
                mc=change;
                ans=initial[i];
            }
        }
        return ans;


    }
};